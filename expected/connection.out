-- ===================================================================
-- create test functions
-- ===================================================================
CREATE FUNCTION test_pg_shard_connection(text, integer, text)
	RETURNS void
	AS 'pg_shard', 'TestPgShardConnection'
	LANGUAGE C STRICT;
-- ===================================================================
-- test connection hash functionality
-- ===================================================================
-- test connection to localhost raising an info message
SELECT test_pg_shard_connection('', 5432, 'INFO');
 test_pg_shard_connection 
--------------------------
 
(1 row)

-- test connection to localhost raising an exception
SELECT test_pg_shard_connection('', 5432, 'EXCEPTION');
ERROR:  Raised remotely!
CONTEXT:  Remote SQL command: DO $$ BEGIN RAISE EXCEPTION 'Raised remotely!'; END $$
-- test connection to non-existant machine
SELECT test_pg_shard_connection('dummyhost', 5432, 'INFO');
ERROR:  could not connect to node "dummyhost" (on port 5432)
DETAIL:  could not translate host name "dummyhost" to address: nodename nor servname provided, or not known
